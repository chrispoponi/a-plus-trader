# Quantitative Position Sizing: The Conviction Multiplier

## The Problem
Equal weighting (0.75% risk per trade) fails to capitalize on "Fat Tail" eventsâ€”those rare, exceptional setups (A+ trades) that contribute disproportionately to portfolio growth.

## The Solution: Dynamic Scoring
We utilize the `overall_rank_score` (0-100) generated by the Strategy Engine to scale position size dynamically.

### THE FORMULA
We apply a **Squared Edge Multiplier** to bias heavily towards the highest quality setups.

```python
def calculate_dynamic_risk(base_risk_pct, score, threshold=70):
    # 1. Calculate Ratio (e.g. 95 / 70 = 1.35)
    ratio = score / threshold
    
    # 2. Square it for Convexity (Rewards outliers more than linear)
    # 1.35^2 = 1.84x
    multiplier = ratio ** 2
    
    # 3. Apply to Base Risk
    dynamic_risk = base_risk_pct * multiplier
    
    # 4. Safety Caps
    # Floor: 0.50% (Don't waste focus on tiny trades)
    # Ceiling: 2.00% (Never bet the farm)
    dynamic_risk = max(0.50, min(dynamic_risk, 2.0))
    
    return dynamic_risk
```

### Risk Ladder Scenario (Base Risk = 0.75%)

| Scenario | Score | Math | New Risk % | Dollar Risk ($100k Acct) |
| :--- | :--- | :--- | :--- | :--- |
| **Weak Trend** | 60 | $(60/70)^2 = 0.73$ | **0.55%** | $550 |
| **Standard** | 70 | $(70/70)^2 = 1.00$ | **0.75%** | $750 |
| **Strong** | 80 | $(80/70)^2 = 1.30$ | **0.98%** | $980 |
| **Exceptional**| 90 | $(90/70)^2 = 1.65$ | **1.24%** | $1,240 |
| **A+ Perfect** | 98 | $(98/70)^2 = 1.96$ | **1.47%** | $1,470 |

### Expected Outcome
- **Drawdown Reduction**: Weaker trades (Style drift) hurt less.
- **CAGR Exposure**: Winning streaks on A+ setups compound significantly faster due to near-double sizing.

## Implementation Details
- **File**: `executor_service/order_executor.py`
- **Method**: `calculate_position_size`
- **Input**: Requires `Candidate.scores.overall_rank_score`.
